name: Update RSS Feed

on:
  schedule:
    - cron: "0 0 * * *" # Runs daily at midnight UTC
  workflow_dispatch: # Allows manual trigger

jobs:
  update-feed:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '6.0.x'

      - name: Compile C# Script
        run: dotnet new console -o rss-gen && mv GenerateRSS.cs rss-gen/Program.cs && cd rss-gen && dotnet build

      - name: Run RSS Generator
        run: cd rss-gen && dotnet run && mv rss.xml ../

      - name: Commit and Push if Changed
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "github-actions@github.com"
          git add rss.xml
          if git diff --quiet && git diff --staged --quiet; then
            echo "No changes to commit"
          else
            git commit -m "Update RSS feed"
            git push
          fi
